<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: rslurm: Submit R calculations to a SLURM cluster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rslurm-package"><tr><td>rslurm-package</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>rslurm: Submit R calculations to a SLURM cluster</h2>

<h3>Description</h3>

<p>This package automates the process of sending simple function calls or 
parallel calculations to a cluster using the SLURM workload manager.
</p>


<h3>Overview</h3>

<p>This package includes two core functions used to send computations to a 
SLURM cluster. While <code>slurm_call</code> executes a function using a
single set of parameters (passed as a list), <code>slurm_apply</code>
evaluates the function in parallel for multiple sets of parameters grouped
in a data frame. <code>slurm_apply</code> automatically splits the parameter
sets into equal-size chunks, each chunk to be processed by a separate
cluster node. It uses functions from the <code>parallel</code>
package to parallelize computations within each node.
</p>
<p>The output of <code>slurm_apply</code> or <code>slurm_call</code> is a 
<code>slurm_job</code> object that serves as an input to the other functions 
in the package: <code>print_job_status</code>, <code>cancel_slurm</code>, 
<code>get_slurm_out</code> and <code>cleanup_files</code>.
</p>
<p>For bug reports or questions about this package, contact 
Ian Carroll(icarroll@sesync.org).
</p>


<h3>Function Specification</h3>

<p>To be compatible with <code>slurm_apply</code>, a function may accept
any number of single value parameters. The names of these parameters must 
match the column names of the <code>params</code> data frame supplied. There are no
restrictions on the types of parameters passed as a list to 
<code>slurm_call</code>. 
</p>
<p>If the function passed to <code>slurm_call</code> or <code>slurm_apply</code> requires
knowledge of any R objects (data, custom helper functions) besides <code>params</code>,
a character vector corresponding to their names should be passed to the 
optional <code>add_objects</code> argument.
</p>
<p>When parallelizing a function, since any error will interrupt all calculations
for the current node, it may be useful to wrap expressions which may generate
errors into a <code>try</code> or <code>tryCatch</code> function. 
This will ensure the computation continues with the next parameter set after 
reporting the error.
</p>


<h3>Output Format</h3>

<p>The default output format for <code>get_slurm_out</code> (<code>outtype = "raw"</code>)
is a list where each element is the return value of one function call. If the 
function passed to <code>slurm_apply</code> produces a vector output, you may use
<code>outtype = "table"</code> to collect the output in a single data frame, with
one row by function call.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
# Create a data frame of mean/sd values for normal distributions 
pars &lt;- data.frame(par_m = seq(-10, 10, length.out = 1000), 
                   par_sd = seq(0.1, 10, length.out = 1000))
                   
# Create a function to parallelize
ftest &lt;- function(par_m, par_sd) {
 samp &lt;- rnorm(10^7, par_m, par_sd)
 c(s_m = mean(samp), s_sd = sd(samp))
}

sjob1 &lt;- slurm_apply(ftest, pars)
print_job_status(sjob1)
res &lt;- get_slurm_out(sjob1, "table")
all.equal(pars, res) # Confirm correct output
cleanup_files(sjob1)

## End(Not run)

</pre>


</body></html>
